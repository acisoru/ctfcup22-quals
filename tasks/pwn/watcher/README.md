# PWN | hard | Watcher

## Информация

> При входе в PWN-ерскую хату вас встречает смотрящий и задаёт простой вопрос.
> 
> Есть два варианта - syscall или int 80h. Какой сам выберешь, какой другу отдашь?
> 
> nc <ip> 13771
>

## Деплой

```sh
cd deploy
docker-compose up --build -d
```

## Выдать участинкам

Архив из директории [public/](public/) и IP:PORT сервера

## Описание
Запускаем пользовательский код в отдельном процессе и следим за целостностью страницы где выполняется код.

## Решение

1. Получить утечку libc можно по оффсету из fs-регистра
2. Стек можно восстановить чреез fs:0x300 или просто выделить его себе
3. После инициализации стека можно спокойной использовать любые функции из libc
4. Вероятно есть разные способы решения, авторский заключается в атаке по стороннему каналу
5. С помощью сообщения о изменении страницы с кодом, которое выводит watcher можно ликать по 1 биту флага

[пример эксплоита](solve/splo2.py)

## Флаг

`CUP{0H_h1_M4rk!}`

