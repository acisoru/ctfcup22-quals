# PWN | medium | OZNE

## Информация

> Этот простой сервис мы нашли на просторах сети
>
> nc <ip> 13774
>

## Деплой

```sh
cd deploy
docker-compose up --build -d
```

## Выдать участинкам

Архив из директории [public/](public/) и IP:PORT сервера

## Описание
Есть возможность выделить насколько угодно большой чанк через malloc и сделать один AR и AW на 8 байт последовательно

## Решение

1. Выделяем чанк так, чтобы он выделился через mmap (больше чем MMAP_THRESHOLD)
2. Сразу после него будет лежать libc, что позволит очень просто ликнуть адрес
3. Переписываем GOT strlen внутри libc на system
4. При последнем форматированном выводе вызовется strlen, который будет заменён system в него передаётся имя пользователя


[пример эксплоита](solve/sploit.py)

## Флаг

`CUP{d0_y0u_l1ke_OZNE_mus1c_t0?_aef0941bcdf91}`