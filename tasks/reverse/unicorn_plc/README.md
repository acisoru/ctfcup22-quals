# Reverse | Medium | Фирма "Единорог"

## Информация 
> На конференции по импортозамещению появился новый игрок. На их стенде мы взяли демо новой программы для защиты каналов связи между ПЛК, но за ключ активации они попросили $1337... Я видел как их прогеры активно ругались на дедлайны рядом со стендом, может быть с их демо что-то не так? Да и вообще похоже на какой-то обман, надо бы проверить что там внутри.

## Выдать участникам
Архив plc_demo.zip

## Описание
Крякмиха, где разные куски флага проверяются простым кодом для различных архитектур при помощи Unicorn Engine.

## Решение

1) Открыть бинарь
2) Найти точку входа, откуда можно начать реверсить.
3) Бинарь весь пострипаный и статически линкованный, но нам не нужно определять все функи - основных будет достаточно.
4) Собственно, когда определили большую часть стандартных фунок uc (я не знаю как это подробнее описать, 2 часа сидим и смотрим в иду?) понимаем что у нас запускается три куска кода - под mips, powerpc и spark32.
5) Дальше я вижу два пути решения
    а) Раскурить код, который эмулируется - например используя иду или [этот сайт](https://shell-storm.org/online/Online-Assembler-and-Disassembler/)
    б) Переписать эмуляцию под питон\си и просто набрутить куски флага. Это будет проще, если вы раскурили всю логику настройки и запуска эмуляции (ну или почитали доки).